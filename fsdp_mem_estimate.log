================================================================================
                    FSDP Memory Estimation for debug_simpleFSDP.sh Configs
================================================================================
[2025-07-25 06:31:11] Script started: ./scripts/estimate/estimate_fsdp_memory.sh
[2025-07-25 06:31:11] Working directory: /root/torchtitan
[2025-07-25 06:31:11] Output directory: /root/torchtitan/fsdp_memory_estimates
[2025-07-25 06:31:11] Log file: /root/torchtitan/fsdp_memory_estimates/fsdp_estimates_20250725_063111.log
[2025-07-25 06:31:11] 
[2025-07-25 06:31:11] === Estimating: llama3_8b, batch_size=1, activation_checkpoint=none ===
[2025-07-25 06:31:11] Config: ./torchtitan/models/llama3/train_configs/llama3_8b.toml
[2025-07-25 06:31:11] Overrides: --model.flavor 8B --training.local_batch_size 1 --training.seq_len 8192 --activation_checkpoint.mode none 
[2025-07-25 06:31:11] 
[titan] 2025-07-25 06:31:45,642 - root - INFO - Estimating memory usage...
[titan] 2025-07-25 06:31:45,642 - root - INFO - Compile mode is not supported yet. Switching to eager mode.
[titan] 2025-07-25 06:31:45,645 - root - INFO - Building 1-D device mesh with ['dp_shard'], [4]
[titan] 2025-07-25 06:31:46,096 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[titan] 2025-07-25 06:31:47,067 - root - INFO - Applied FSDP to the model
[titan] 2025-07-25 06:31:47,614 - root - INFO - Vocab size: 128256
Peak Memory at iter: 0
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ==========  ========  ============
Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp        All Gather    Reduce Scatter    OptState    Inputs    Total
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ==========  ========  ============
cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           49226.06 MiB  8016.0 MiB  0.0 MiB       0.0 MiB           0.0 MiB     0.12 MiB  65320.46 MiB
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ==========  ========  ============
Peak Memory at iter: 1
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp        All Gather    Reduce Scatter    OptState      Inputs    Total
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           49226.06 MiB  8016.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  80637.11 MiB
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Module:  FSDPTransformer
========================  ========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp        All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           47222.06 MiB  0.0 MiB     416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  73037.13 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   0.0 MiB         0.0 MiB           0.0 MiB       0.0 MiB     0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  22979.03 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           0.0 MiB       0.0 MiB     2004.01 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  26987.04 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           47222.06 MiB  0.0 MiB     416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  73037.13 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           47222.06 MiB  0.0 MiB     0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  70617.11 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45218.06 MiB  2004.0 MiB  2004.01 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  74625.12 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           45218.06 MiB  2004.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  70617.11 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45218.06 MiB  2004.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  72621.12 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6656.25 MiB     2004.01 MiB       0.0 MiB       0.0 MiB     0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  34475.33 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   7658.25 MiB     1002.0 MiB        0.0 MiB       0.0 MiB     0.0 MiB       4008.02 MiB       15316.65 MiB  0.12 MiB  35647.3 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.0
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           64.0 MiB      0.0 MiB      2420.02 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  27883.08 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           64.0 MiB      0.0 MiB      2004.01 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  27051.04 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           64.0 MiB      0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25879.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1473.06 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27288.13 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1473.06 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26872.12 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           1185.06 MiB   1850.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  35714.4 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           1409.06 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35154.4 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           1409.06 MiB   1066.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  35154.4 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     416.02 MiB        0.0 MiB       1066.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  34161.35 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6656.25 MiB     0.01 MiB          0.0 MiB       1066.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  33537.33 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.1
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2946.13 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28761.2 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1473.06 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26872.12 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1473.06 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27288.13 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2882.13 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28697.2 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2882.13 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28281.18 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           2594.13 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  37331.47 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           2818.13 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  36355.45 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           2818.13 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  36771.47 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     416.02 MiB        1409.06 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35778.42 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6448.24 MiB     0.01 MiB          1409.06 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35154.41 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.2
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4355.19 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  30170.26 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2882.13 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28281.18 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2882.13 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28697.2 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4291.19 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  30106.26 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4291.19 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  29690.24 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           4003.19 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  38532.52 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           4227.19 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  37556.51 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           4227.19 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  37972.52 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     416.02 MiB        2818.13 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  36979.48 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6240.23 MiB     0.01 MiB          2818.13 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  36355.46 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.3
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5764.25 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  31579.32 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4291.19 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  29690.24 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4291.19 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  30106.26 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5700.25 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  31515.32 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5700.25 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  31099.31 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           5412.25 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  39733.58 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           5636.25 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  38757.56 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           5636.25 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  39173.58 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     416.02 MiB        4227.19 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  38180.53 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6032.23 MiB     0.01 MiB          4227.19 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  37556.52 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.4
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7173.32 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  32988.39 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5700.25 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  31099.31 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5700.25 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  31515.32 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7109.32 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  32924.39 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7109.32 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  32508.37 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           6821.32 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  40934.64 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           7045.32 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  39958.62 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           7045.32 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  40374.64 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     416.02 MiB        5636.25 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  39381.59 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5824.22 MiB     0.01 MiB          5636.25 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  38757.57 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.5
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8582.38 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  34397.45 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7109.32 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  32508.37 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7109.32 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  32924.39 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8518.38 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  34333.45 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8518.38 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  33917.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           8230.38 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  42135.69 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           8454.38 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  41159.68 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           8454.38 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  41575.69 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      416.02 MiB        7045.32 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  40582.64 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5616.21 MiB     0.01 MiB          7045.32 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  39958.63 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.6
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9991.44 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  35806.51 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8518.38 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  33917.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8518.38 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  34333.45 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9927.44 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  35742.51 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9927.44 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  35326.5 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           9639.45 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  43336.75 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           9863.45 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  42360.73 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           9863.45 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  42776.75 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      416.02 MiB        8454.38 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  41783.7 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5408.2 MiB      0.01 MiB          8454.38 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  41159.68 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.7
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11400.51 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  37215.58 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9927.44 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  35326.5 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9927.44 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  35742.51 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11336.51 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  37151.58 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11336.51 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  36735.56 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           11048.51 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  44537.8 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           11272.51 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  43561.79 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           11272.51 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  43977.8 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     416.02 MiB        9863.45 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  42984.76 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5200.2 MiB      0.01 MiB          9863.45 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  42360.74 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.8
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           12809.57 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  38624.64 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11336.51 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  36735.56 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11336.51 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  37151.58 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           12745.57 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  38560.64 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           12745.57 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  38144.62 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           12457.57 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  45738.86 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           12681.57 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  44762.84 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           12681.57 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  45178.86 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     416.02 MiB        11272.51 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  44185.81 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4992.19 MiB     0.01 MiB          11272.51 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  43561.8 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.9
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           14218.64 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  40033.7 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           12745.57 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  38144.62 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           12745.57 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  38560.64 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           14154.64 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  39969.7 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           14154.64 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  39553.69 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           13866.64 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  46939.91 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           14090.64 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  45963.9 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           14090.64 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  46379.91 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     416.02 MiB        12681.57 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  45386.87 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4784.18 MiB     0.01 MiB          12681.57 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  44762.85 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.10
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           15627.7 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  41442.77 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           14154.64 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  39553.69 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           14154.64 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  39969.7 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           15563.7 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  41378.77 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           15563.7 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  40962.75 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           15275.7 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  48140.97 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           15499.7 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  47164.95 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           15499.7 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  47580.97 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     416.02 MiB        14090.64 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  46587.92 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4576.17 MiB     0.01 MiB          14090.64 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  45963.91 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.11
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           17036.76 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  42851.83 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           15563.7 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  40962.75 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           15563.7 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  41378.77 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           16972.76 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  42787.83 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           16972.76 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  42371.81 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           16684.76 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  49342.03 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           16908.76 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  48366.01 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           16908.76 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  48782.03 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     416.02 MiB        15499.7 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  47788.98 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4368.16 MiB     0.01 MiB          15499.7 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  47164.96 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.12
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           18445.83 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  44260.89 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           16972.76 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  42371.81 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           16972.76 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  42787.83 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           18381.83 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  44196.89 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           18381.83 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  43780.88 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           18093.83 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  50543.08 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           18317.83 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  49567.07 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           18317.83 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  49983.08 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     416.02 MiB        16908.76 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  48990.03 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4160.16 MiB     0.01 MiB          16908.76 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  48366.02 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.13
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           19854.89 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  45669.96 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           18381.83 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  43780.88 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           18381.83 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  44196.89 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           19790.89 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  45605.96 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           19790.89 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  45189.94 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           19502.89 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  51744.14 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           19726.89 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  50768.12 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           19726.89 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  51184.14 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     416.02 MiB        18317.83 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  50191.09 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3952.15 MiB     0.01 MiB          18317.83 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  49567.07 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.14
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           21263.95 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  47079.02 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           19790.89 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  45189.94 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           19790.89 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  45605.96 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           21199.95 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  47015.02 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           21199.95 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  46599.0 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           20911.95 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  52945.19 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           21135.95 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  51969.18 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           21135.95 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  52385.19 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     416.02 MiB        19726.89 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  51392.15 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3744.14 MiB     0.01 MiB          19726.89 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  50768.13 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.15
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           22673.02 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  48488.08 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           21199.95 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  46599.0 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           21199.95 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  47015.02 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           22609.02 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  48424.08 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           22609.02 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  48008.07 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           22321.02 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  54146.25 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           22545.02 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  53170.23 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           22545.02 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  53586.25 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     416.02 MiB        21135.95 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  52593.2 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3536.13 MiB     0.01 MiB          21135.95 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  51969.19 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.16
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           24082.08 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  49897.15 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           22609.02 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  48008.07 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           22609.02 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  48424.08 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           24018.08 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  49833.15 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           24018.08 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  49417.13 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           23730.08 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  55347.3 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           23954.08 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  54371.29 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           23954.08 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  54787.3 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     416.02 MiB        22545.02 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  53794.26 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3328.12 MiB     0.01 MiB          22545.02 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  53170.24 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.17
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           25491.14 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  51306.21 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           24018.08 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  49417.13 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           24018.08 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  49833.15 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           25427.14 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  51242.21 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           25427.14 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  50826.2 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           25139.14 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  56548.36 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           25363.14 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  55572.34 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           25363.14 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  55988.36 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     416.02 MiB        23954.08 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  54995.31 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3120.12 MiB     0.01 MiB          23954.08 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  54371.3 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.18
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           26900.21 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  52715.27 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           25427.14 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  50826.2 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           25427.14 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  51242.21 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           26836.21 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  52651.27 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           26836.21 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  52235.26 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           26548.21 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  57749.42 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           26772.21 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  56773.4 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           26772.21 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  57189.42 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      416.02 MiB        25363.14 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  56196.37 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2912.11 MiB     0.01 MiB          25363.14 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  55572.35 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.19
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           28309.27 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  54124.34 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           26836.21 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  52235.26 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           26836.21 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  52651.27 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           28245.27 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  54060.34 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           28245.27 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  53644.32 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           27957.27 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  58950.47 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           28181.27 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  57974.46 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           28181.27 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  58390.47 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     416.02 MiB        26772.21 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  57397.42 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2704.1 MiB      0.01 MiB          26772.21 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  56773.41 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.20
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           29718.33 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  55533.4 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           28245.27 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  53644.32 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           28245.27 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  54060.34 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           29654.33 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  55469.4 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           29654.33 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  55053.39 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           29366.33 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  60151.53 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           29590.33 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  59175.51 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           29590.33 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  59591.53 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     416.02 MiB        28181.27 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  58598.48 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2496.09 MiB     0.01 MiB          28181.27 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  57974.46 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.21
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           31127.4 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  56942.46 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           29654.33 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  55053.39 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           29654.33 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  55469.4 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           31063.4 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  56878.46 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           31063.4 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  56462.45 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           30775.4 MiB   1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  61352.58 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           30999.4 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  60376.57 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           30999.4 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  60792.58 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     416.02 MiB        29590.33 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  59799.53 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2288.09 MiB     0.01 MiB          29590.33 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  59175.52 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.22
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           32536.46 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  58351.53 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           31063.4 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  56462.45 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           31063.4 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  56878.46 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           32472.46 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  58287.53 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           32472.46 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  57871.51 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           32184.46 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  62553.64 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           32408.46 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  61577.62 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           32408.46 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  61993.64 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     416.02 MiB        30999.4 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  61000.59 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2080.08 MiB     0.01 MiB          30999.4 MiB   1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  60376.57 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.23
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           33945.52 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  59760.59 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           32472.46 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  57871.51 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           32472.46 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  58287.53 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           33881.52 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  59696.59 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           33881.52 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  59280.58 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           33593.52 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  63754.69 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           33817.52 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  62778.68 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           33817.52 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  63194.69 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     416.02 MiB        32408.46 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  62201.65 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1872.07 MiB     0.01 MiB          32408.46 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  61577.63 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.24
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           35354.59 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  61169.66 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           33881.52 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  59280.58 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           33881.52 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  59696.59 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           35290.59 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  61105.66 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           35290.59 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  60689.64 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           35002.59 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  64955.75 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           35226.59 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  63979.73 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           35226.59 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  64395.75 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     416.02 MiB        33817.52 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  63402.7 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1664.06 MiB     0.01 MiB          33817.52 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  62778.69 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.25
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           36763.65 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  62578.72 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           35290.59 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  60689.64 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           35290.59 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  61105.66 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           36699.65 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  62514.72 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           36699.65 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  62098.7 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           36411.65 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  66156.81 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           36635.65 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  65180.79 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           36635.65 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  65596.81 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     416.02 MiB        35226.59 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  64603.76 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1456.05 MiB     0.01 MiB          35226.59 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  63979.74 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.26
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           38172.71 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  63987.78 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           36699.65 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  62098.7 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           36699.65 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  62514.72 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           38108.71 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  63923.78 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           38108.71 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  63507.77 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           37820.71 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  67357.86 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           38044.71 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  66381.85 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           38044.71 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  66797.86 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     416.02 MiB        36635.65 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  65804.81 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1248.05 MiB     0.01 MiB          36635.65 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  65180.8 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.27
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           39581.78 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  65396.85 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           38108.71 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  63507.77 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           38108.71 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  63923.78 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           39517.78 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  65332.85 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           39517.78 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  64916.83 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      0.0 MiB           39229.78 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  68558.92 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   832.03 MiB      0.0 MiB           39453.78 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  67582.9 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      0.0 MiB           39453.78 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  67998.92 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      416.02 MiB        38044.71 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  67005.87 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1040.04 MiB     0.01 MiB          38044.71 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  66381.85 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.28
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           40990.84 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  66805.91 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           39517.78 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  64916.83 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           39517.78 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  65332.85 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           40926.84 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  66741.91 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           40926.84 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  66325.89 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      0.0 MiB           40638.84 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  69759.97 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   624.02 MiB      0.0 MiB           40862.84 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  68783.96 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      0.0 MiB           40862.84 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  69199.97 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      416.02 MiB        39453.78 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  68206.92 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   832.03 MiB      0.01 MiB          39453.78 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  67582.91 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.29
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           42399.9 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  68214.97 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           40926.84 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  66325.89 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           40926.84 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  66741.91 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           42335.9 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  68150.97 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           42335.9 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  67734.96 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      0.0 MiB           42047.91 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  70961.03 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   416.02 MiB      0.0 MiB           42271.91 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  69985.01 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      0.0 MiB           42271.91 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  70401.03 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      416.02 MiB        40862.84 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  69407.98 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   624.02 MiB      0.01 MiB          40862.84 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  68783.96 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.30
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           43808.97 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  69624.04 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           42335.9 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  67734.96 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           42335.9 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  68150.97 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           43744.97 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  69560.04 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           43744.97 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  69144.02 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      0.0 MiB           43456.97 MiB  1850.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  72162.08 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   208.01 MiB      0.0 MiB           43680.97 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  71186.07 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      0.0 MiB           43680.97 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  71602.08 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      416.02 MiB        42271.91 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  70609.04 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   416.02 MiB      0.01 MiB          42271.91 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  69985.02 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.31
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45218.03 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  71033.1 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           43744.97 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  69144.02 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           43744.97 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  69560.04 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45154.03 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  70969.1 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45154.03 MiB  0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  70969.1 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           44866.03 MiB  1850.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  72531.11 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45090.03 MiB  1066.01 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  71555.09 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           45090.03 MiB  1066.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  71971.11 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         416.02 MiB        43680.97 MiB  1066.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  70978.06 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   208.01 MiB      0.01 MiB          43680.97 MiB  1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  71186.08 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
peak active: 4.76837158203125e-07 GiB | peak reserved: 0.001953125 GiB | num_retries: 0
Tracker Max: 78.74717569351196 GiB
[2025-07-25 06:31:56] ✓ Estimation completed successfully
[2025-07-25 06:31:56] 
[2025-07-25 06:31:56] === Estimating: llama3_8b, batch_size=1, activation_checkpoint=full ===
[2025-07-25 06:31:56] Config: ./torchtitan/models/llama3/train_configs/llama3_8b.toml
[2025-07-25 06:31:56] Overrides: --model.flavor 8B --training.local_batch_size 1 --training.seq_len 8192 --activation_checkpoint.mode full 
[2025-07-25 06:31:56] 
[titan] 2025-07-25 06:32:23,020 - root - INFO - Estimating memory usage...
[titan] 2025-07-25 06:32:23,020 - root - INFO - Compile mode is not supported yet. Switching to eager mode.
[titan] 2025-07-25 06:32:23,020 - root - INFO - Building 1-D device mesh with ['dp_shard'], [4]
[titan] 2025-07-25 06:32:23,250 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[titan] 2025-07-25 06:32:23,414 - root - INFO - Applied full activation checkpointing to the model
[titan] 2025-07-25 06:32:24,117 - root - INFO - Applied FSDP to the model
[titan] 2025-07-25 06:32:24,654 - root - INFO - Vocab size: 128256
Peak Memory at iter: 0
========  ===============  =================  ========  ==============  ================  ============  =======  ============  ================  ============  ========  ============
Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp     All Gather    Reduce Scatter    OptState      Inputs    Total
========  ===============  =================  ========  ==============  ================  ============  =======  ============  ================  ============  ========  ============
cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   7658.25 MiB     0.0 MiB           0.0 MiB       0.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  30637.28 MiB
========  ===============  =================  ========  ==============  ================  ============  =======  ============  ================  ============  ========  ============
Peak Memory at iter: 1
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp        All Gather    Reduce Scatter    OptState      Inputs    Total
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           6184.03 MiB   8016.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  37595.08 MiB
========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Module:  FSDPTransformer
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4180.03 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  29995.1 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   0.0 MiB         0.0 MiB           0.0 MiB       0.0 MiB      0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  22979.03 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           0.0 MiB       0.0 MiB      2004.01 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  26987.04 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4180.03 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  29995.1 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           4180.03 MiB   0.0 MiB      0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  27575.08 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           128.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35986.41 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           2176.03 MiB   2004.0 MiB   0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  27575.08 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2176.03 MiB   2004.0 MiB   0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  29579.08 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6656.25 MiB     2004.01 MiB       0.0 MiB       0.0 MiB      0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  34475.33 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   7658.25 MiB     1002.0 MiB        0.0 MiB       0.0 MiB      0.0 MiB       4008.02 MiB       15316.65 MiB  0.12 MiB  35647.3 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.0
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           64.0 MiB      0.0 MiB      2420.02 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  27883.08 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           64.0 MiB      0.0 MiB      2004.01 MiB   0.0 MiB           15316.65 MiB  0.12 MiB  27051.04 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           64.0 MiB      0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25879.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           128.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25943.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           128.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25527.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           64.0 MiB      2971.07 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  35714.4 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           64.0 MiB      1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33809.33 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           64.0 MiB      1066.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  33809.33 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     416.02 MiB        0.0 MiB       1066.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  34161.35 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6656.25 MiB     0.01 MiB          0.0 MiB       1066.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.12 MiB  33537.33 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.1
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           928.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26743.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           128.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25527.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           128.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25943.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           192.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26007.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           192.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25591.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           128.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35986.41 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           128.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33665.33 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           128.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34081.34 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     416.02 MiB        64.0 MiB      1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34433.36 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6448.24 MiB     0.01 MiB          64.0 MiB      1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33809.34 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.2
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           992.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26807.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           192.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25591.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           192.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26007.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           256.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26071.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           256.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25655.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           192.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35842.4 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           192.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33521.32 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           192.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33937.33 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     416.02 MiB        128.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34289.35 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6240.23 MiB     0.01 MiB          128.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33665.33 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.3
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1056.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26871.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           256.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25655.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           256.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26071.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           320.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26135.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           320.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25719.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           256.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35698.39 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           256.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33377.31 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           256.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33793.33 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     416.02 MiB        192.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34145.34 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6032.23 MiB     0.01 MiB          192.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33521.33 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.4
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1120.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26935.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           320.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25719.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           320.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26135.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           384.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26199.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           384.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25783.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           320.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35554.38 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           320.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33233.3 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           320.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33649.32 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     416.02 MiB        256.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34001.33 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5824.22 MiB     0.01 MiB          256.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33377.32 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.5
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1184.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26999.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           384.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25783.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           384.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26199.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           448.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26263.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           448.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25847.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           384.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35410.37 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           384.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33089.3 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           384.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33505.31 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      416.02 MiB        320.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33857.33 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5616.21 MiB     0.01 MiB          320.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33233.31 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.6
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1248.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27063.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           448.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25847.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           448.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26263.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26327.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25911.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           448.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35266.37 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           448.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32945.29 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           448.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33361.3 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      416.02 MiB        384.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33713.32 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5408.2 MiB      0.01 MiB          384.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33089.3 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.7
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1312.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27127.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25911.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26327.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           576.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26391.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           576.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25975.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           512.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  35122.36 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           512.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32801.28 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           512.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33217.3 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     416.02 MiB        448.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33569.31 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5200.2 MiB      0.01 MiB          448.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32945.3 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.8
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1376.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27191.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           576.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  25975.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           576.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26391.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           640.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26455.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           640.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26039.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           576.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34978.35 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           576.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32657.27 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           576.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33073.29 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     416.02 MiB        512.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33425.3 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4992.19 MiB     0.01 MiB          512.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32801.29 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.9
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1440.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27255.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           640.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26039.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           640.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26455.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           704.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26519.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           704.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26103.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           640.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34834.34 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           640.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32513.26 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           640.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32929.28 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     416.02 MiB        576.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33281.3 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4784.18 MiB     0.01 MiB          576.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32657.28 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.10
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1504.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27319.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           704.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26103.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           704.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26519.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26583.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26167.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           704.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34690.34 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           704.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32369.26 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           704.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32785.27 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     416.02 MiB        640.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33137.29 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4576.17 MiB     0.01 MiB          640.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32513.27 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.11
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1568.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27383.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26167.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26583.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           832.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26647.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           832.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26231.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           768.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34546.33 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           768.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32225.25 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           768.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32641.26 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     416.02 MiB        704.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32993.28 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4368.16 MiB     0.01 MiB          704.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32369.26 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.12
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1632.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27447.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           832.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26231.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           832.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26647.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           896.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26711.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           896.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26295.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           832.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34402.32 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           832.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32081.24 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           832.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32497.26 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     416.02 MiB        768.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32849.27 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4160.16 MiB     0.01 MiB          768.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32225.26 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.13
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1696.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27511.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           896.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26295.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           896.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26711.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           960.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26775.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           960.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26359.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           896.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34258.31 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           896.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31937.23 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           896.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32353.25 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     416.02 MiB        832.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32705.26 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3952.15 MiB     0.01 MiB          832.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32081.25 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.14
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1760.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27575.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           960.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26359.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           960.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26775.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26839.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26423.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           960.0 MiB     2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  34114.3 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           960.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31793.23 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           960.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32209.24 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     416.02 MiB        896.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32561.26 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3744.14 MiB     0.01 MiB          896.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31937.24 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.15
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1824.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27639.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26423.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26839.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1088.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26903.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1088.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26487.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           1024.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33970.3 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           1024.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31649.22 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           1024.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32065.23 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     416.02 MiB        960.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32417.25 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3536.13 MiB     0.01 MiB          960.0 MiB     1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31793.23 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.16
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1888.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27703.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1088.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26487.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1088.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26903.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1152.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26967.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1152.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26551.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           1088.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33826.29 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           1088.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31505.21 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           1088.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31921.23 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     416.02 MiB        1024.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32273.24 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3328.12 MiB     0.01 MiB          1024.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31649.23 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.17
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1952.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27767.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1152.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26551.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1152.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26967.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1216.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27031.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1216.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26615.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           1152.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33682.28 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           1152.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31361.2 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           1152.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31777.22 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     416.02 MiB        1088.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32129.23 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3120.12 MiB     0.01 MiB          1088.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31505.22 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.18
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2016.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27831.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1216.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26615.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1216.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27031.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27095.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26679.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           1216.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33538.27 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           1216.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31217.19 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           1216.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31633.21 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      416.02 MiB        1152.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31985.23 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2912.11 MiB     0.01 MiB          1152.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31361.21 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.19
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2080.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27895.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26679.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27095.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1344.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27159.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1344.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26743.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           1280.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33394.27 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           1280.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31073.19 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           1280.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31489.2 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     416.02 MiB        1216.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31841.22 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2704.1 MiB      0.01 MiB          1216.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31217.2 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.20
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2144.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27959.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1344.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26743.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1344.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27159.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1408.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27223.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1408.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26807.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           1344.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33250.26 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           1344.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30929.18 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           1344.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31345.19 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     416.02 MiB        1280.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31697.21 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2496.09 MiB     0.01 MiB          1280.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31073.19 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.21
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2208.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28023.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1408.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26807.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1408.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27223.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1472.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27287.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1472.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26871.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           1408.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  33106.25 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           1408.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30785.17 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           1408.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31201.19 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     416.02 MiB        1344.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31553.2 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2288.09 MiB     0.01 MiB          1344.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30929.19 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.22
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2272.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28087.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1472.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26871.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1472.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27287.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27351.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26935.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           1472.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32962.24 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           1472.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30641.16 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           1472.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31057.18 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     416.02 MiB        1408.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31409.19 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2080.08 MiB     0.01 MiB          1408.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30785.18 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.23
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2336.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28151.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26935.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27351.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1600.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27415.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1600.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26999.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           1536.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32818.23 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           1536.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30497.15 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           1536.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30913.17 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     416.02 MiB        1472.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31265.19 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1872.07 MiB     0.01 MiB          1472.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30641.17 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.24
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2400.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28215.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1600.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  26999.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1600.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27415.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1664.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27479.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1664.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27063.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           1600.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32674.23 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           1600.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30353.15 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           1600.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30769.16 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     416.02 MiB        1536.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31121.18 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1664.06 MiB     0.01 MiB          1536.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30497.16 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.25
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2464.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28279.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1664.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27063.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1664.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27479.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1728.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27543.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1728.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27127.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           1664.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32530.22 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           1664.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30209.14 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           1664.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30625.15 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     416.02 MiB        1600.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30977.17 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1456.05 MiB     0.01 MiB          1600.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30353.15 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.26
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2528.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28343.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1728.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27127.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1728.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27543.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27607.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27191.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           1728.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32386.21 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           1728.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30065.13 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           1728.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30481.15 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     416.02 MiB        1664.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30833.16 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1248.05 MiB     0.01 MiB          1664.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30209.15 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.27
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2592.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28407.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27191.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27607.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1856.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27671.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1856.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27255.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      0.0 MiB           1792.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32242.2 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   832.03 MiB      0.0 MiB           1792.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29921.12 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      0.0 MiB           1792.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30337.14 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      416.02 MiB        1728.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30689.15 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1040.04 MiB     0.01 MiB          1728.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30065.14 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.28
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2656.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28471.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1856.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27255.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1856.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27671.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1920.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27735.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1920.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27319.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      0.0 MiB           1856.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  32098.19 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   624.02 MiB      0.0 MiB           1856.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29777.12 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      0.0 MiB           1856.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30193.13 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      416.02 MiB        1792.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30545.15 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   832.03 MiB      0.01 MiB          1792.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29921.13 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.29
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2720.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28535.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1920.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27319.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1920.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27735.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1984.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27799.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1984.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27383.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      0.0 MiB           1920.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31954.19 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   416.02 MiB      0.0 MiB           1920.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29633.11 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      0.0 MiB           1920.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30049.12 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      416.02 MiB        1856.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30401.14 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   624.02 MiB      0.01 MiB          1856.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29777.12 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.30
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2784.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28599.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1984.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27383.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1984.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27799.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27863.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27447.05 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      0.0 MiB           1984.0 MiB    2971.07 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  31810.18 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   208.01 MiB      0.0 MiB           1984.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29489.1 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      0.0 MiB           1984.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29905.12 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      416.02 MiB        1920.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  30257.13 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   416.02 MiB      0.01 MiB          1920.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29633.12 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.31
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2848.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28663.07 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27447.05 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27863.07 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2112.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27927.07 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2112.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  27927.07 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    2971.07 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  30834.14 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    1066.01 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.12 MiB  28513.06 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    1066.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  28929.08 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         416.02 MiB        1984.0 MiB    1066.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.12 MiB  29281.09 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   208.01 MiB      0.01 MiB          1984.0 MiB    1066.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.12 MiB  29489.11 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
peak active: 4.76837158203125e-07 GiB | peak reserved: 0.001953125 GiB | num_retries: 0
Tracker Max: 36.71394205093384 GiB
[2025-07-25 06:32:39] ✓ Estimation completed successfully
[2025-07-25 06:32:39] 
[2025-07-25 06:32:39] === Estimating: llama3_8b, batch_size=4, activation_checkpoint=full ===
[2025-07-25 06:32:39] Config: ./torchtitan/models/llama3/train_configs/llama3_8b.toml
[2025-07-25 06:32:39] Overrides: --model.flavor 8B --training.local_batch_size 4 --training.seq_len 8192 --activation_checkpoint.mode full 
[2025-07-25 06:32:40] 
[titan] 2025-07-25 06:33:11,651 - root - INFO - Estimating memory usage...
[titan] 2025-07-25 06:33:11,651 - root - INFO - Compile mode is not supported yet. Switching to eager mode.
[titan] 2025-07-25 06:33:11,651 - root - INFO - Building 1-D device mesh with ['dp_shard'], [4]
[titan] 2025-07-25 06:33:11,871 - root - INFO - Building llama3 8B with TransformerModelArgs(_enforced='This field is used to enforce all fields have defaults.', dim=4096, n_layers=32, n_heads=32, n_kv_heads=8, vocab_size=128256, multiple_of=1024, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, max_seq_len=8192, depth_init=True, use_flex_attn=False, attn_mask_type='causal', eos_id=0)
[titan] 2025-07-25 06:33:12,034 - root - INFO - Applied full activation checkpointing to the model
[titan] 2025-07-25 06:33:12,746 - root - INFO - Applied FSDP to the model
[titan] 2025-07-25 06:33:13,300 - root - INFO - Vocab size: 128256
Peak Memory at iter: 0
========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ==========  ========  ===========
Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState    Inputs    Total
========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ==========  ========  ===========
cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           24736.13 MiB  32064.0 MiB  0.0 MiB       0.0 MiB           0.0 MiB     0.5 MiB   64878.9 MiB
========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ==========  ========  ===========
Peak Memory at iter: 1
========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           24736.13 MiB  32064.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.5 MiB   80195.55 MiB
========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer
========================  ========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp        All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           16720.13 MiB  0.0 MiB     416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   42535.57 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   0.0 MiB         0.0 MiB           0.0 MiB       0.0 MiB     0.0 MiB       0.0 MiB           15316.65 MiB  0.5 MiB   22979.4 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           0.0 MiB       0.0 MiB     2004.01 MiB   0.0 MiB           15316.65 MiB  0.5 MiB   26987.42 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           16720.13 MiB  0.0 MiB     416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   42535.57 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           16720.13 MiB  0.0 MiB     0.0 MiB       0.0 MiB           15316.65 MiB  0.5 MiB   40115.54 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8704.13 MiB   8016.0 MiB  2004.01 MiB   0.0 MiB           15316.65 MiB  0.5 MiB   44123.56 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      416.02 MiB         4.0 MiB   0.0 MiB         0.0 MiB           8704.13 MiB   8016.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.5 MiB   40115.55 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8704.13 MiB   8016.0 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.5 MiB   42119.55 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6656.25 MiB     2004.01 MiB       0.0 MiB       0.0 MiB     0.0 MiB       832.03 MiB        15316.65 MiB  0.5 MiB   34475.7 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      0.0 MiB            4.0 MiB   7658.25 MiB     1002.0 MiB        0.0 MiB       0.0 MiB     0.0 MiB       4008.02 MiB       15316.65 MiB  0.5 MiB   35647.67 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ==========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.0
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3456.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29271.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           256.0 MiB     0.0 MiB      2004.01 MiB   0.0 MiB           15316.65 MiB  0.5 MiB   27243.42 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           256.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26071.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26327.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   25911.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           256.0 MiB     8542.26 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.5 MiB   41477.96 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           256.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34193.71 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     0.0 MiB           256.0 MiB     1258.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.5 MiB   34193.71 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6448.24 MiB     416.02 MiB        0.0 MiB       1258.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.5 MiB   34353.73 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6656.25 MiB     0.01 MiB          0.0 MiB       1258.01 MiB  0.0 MiB       832.03 MiB        15316.65 MiB  0.5 MiB   33729.71 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.1
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3712.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29527.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   25911.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           512.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26327.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26583.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26167.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           512.0 MiB     8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   41941.97 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           512.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34241.7 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     0.0 MiB           512.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34657.72 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6240.23 MiB     416.02 MiB        256.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34817.73 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6448.24 MiB     0.01 MiB          256.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34193.72 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.2
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3968.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29783.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26167.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           768.0 MiB     0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26583.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26839.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26423.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           768.0 MiB     8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   41989.96 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           768.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34289.69 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     0.0 MiB           768.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34705.71 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   6032.23 MiB     416.02 MiB        512.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34865.73 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6240.23 MiB     0.01 MiB          512.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34241.71 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.3
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4224.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30039.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26423.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1024.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26839.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27095.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26679.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           1024.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42037.95 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           1024.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34337.69 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     0.0 MiB           1024.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34753.7 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5824.22 MiB     416.02 MiB        768.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34913.72 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   6032.23 MiB     0.01 MiB          768.0 MiB     1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34289.7 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.4
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4480.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30295.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26679.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1280.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27095.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27351.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26935.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           1280.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42085.94 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           1280.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34385.68 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     0.0 MiB           1280.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34801.69 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5616.21 MiB     416.02 MiB        1024.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34961.71 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5824.22 MiB     0.01 MiB          1024.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34337.69 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.5
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4736.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30551.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   26935.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1536.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27351.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27607.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27191.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           1536.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42133.94 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           1536.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34433.67 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      0.0 MiB           1536.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34849.69 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5408.2 MiB      416.02 MiB        1280.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35009.7 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5616.21 MiB     0.01 MiB          1280.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34385.69 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.6
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4992.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30807.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27191.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           1792.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27607.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27863.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27447.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           1792.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42181.93 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           1792.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34481.66 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      0.0 MiB           1792.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34897.68 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   5200.2 MiB      416.02 MiB        1536.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35057.69 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5408.2 MiB      0.01 MiB          1536.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34433.68 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.7
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5248.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31063.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27447.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2048.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27863.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2304.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28119.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2304.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27703.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           2048.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42229.92 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           2048.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34529.65 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     0.0 MiB           2048.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34945.67 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4992.19 MiB     416.02 MiB        1792.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35105.69 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   5200.2 MiB      0.01 MiB          1792.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34481.67 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.8
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5504.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31319.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2304.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27703.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2304.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28119.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2560.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28375.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2560.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27959.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           2304.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42277.91 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           2304.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34577.65 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     0.0 MiB           2304.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34993.66 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4784.18 MiB     416.02 MiB        2048.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35153.68 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4992.19 MiB     0.01 MiB          2048.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34529.66 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.9
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5760.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31575.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2560.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   27959.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2560.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28375.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2816.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28631.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2816.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28215.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           2560.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42325.91 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           2560.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34625.64 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     0.0 MiB           2560.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35041.65 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4576.17 MiB     416.02 MiB        2304.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35201.67 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4784.18 MiB     0.01 MiB          2304.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34577.65 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.10
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6016.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31831.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2816.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28215.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           2816.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28631.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3072.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28887.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3072.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28471.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           2816.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42373.9 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           2816.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34673.63 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     0.0 MiB           2816.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35089.65 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4368.16 MiB     416.02 MiB        2560.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35249.66 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4576.17 MiB     0.01 MiB          2560.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34625.65 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.11
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6272.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32087.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3072.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28471.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3072.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28887.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3328.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29143.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3328.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28727.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           3072.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42421.89 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           3072.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34721.62 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     0.0 MiB           3072.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35137.64 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   4160.16 MiB     416.02 MiB        2816.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35297.65 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4368.16 MiB     0.01 MiB          2816.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34673.64 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.12
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6528.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32343.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3328.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28727.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3328.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29143.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3584.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29399.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3584.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28983.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           3328.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42469.88 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           3328.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34769.62 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     0.0 MiB           3328.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35185.63 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3952.15 MiB     416.02 MiB        3072.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35345.65 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   4160.16 MiB     0.01 MiB          3072.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34721.63 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.13
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6784.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32599.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3584.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   28983.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3584.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29399.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3840.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29655.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3840.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29239.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           3584.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42517.87 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           3584.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34817.61 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     0.0 MiB           3584.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35233.62 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3744.14 MiB     416.02 MiB        3328.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35393.64 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3952.15 MiB     0.01 MiB          3328.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34769.62 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.14
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7040.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32855.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3840.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29239.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           3840.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29655.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4096.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29911.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4096.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29495.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           3840.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42565.87 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           3840.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34865.6 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     0.0 MiB           3840.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35281.62 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3536.13 MiB     416.02 MiB        3584.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35441.63 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3744.14 MiB     0.01 MiB          3584.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34817.62 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.15
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7296.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33111.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4096.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29495.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4096.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29911.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4352.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30167.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4352.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29751.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           4096.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42613.86 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           4096.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34913.59 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     0.0 MiB           4096.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35329.61 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3328.12 MiB     416.02 MiB        3840.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35489.62 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3536.13 MiB     0.01 MiB          3840.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34865.61 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.16
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7552.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33367.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4352.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   29751.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4352.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30167.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4608.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30423.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4608.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30007.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           4352.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42661.85 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           4352.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34961.58 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     0.0 MiB           4352.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35377.6 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   3120.12 MiB     416.02 MiB        4096.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35537.62 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3328.12 MiB     0.01 MiB          4096.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34913.6 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.17
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7808.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33623.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4608.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30007.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4608.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30423.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4864.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30679.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4864.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30263.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           4608.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42709.84 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           4608.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35009.58 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     0.0 MiB           4608.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35425.59 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2912.11 MiB     416.02 MiB        4352.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35585.61 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   3120.12 MiB     0.01 MiB          4352.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   34961.59 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.18
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8064.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33879.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4864.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30263.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           4864.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30679.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5120.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30935.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5120.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30519.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           4864.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42757.84 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           4864.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35057.57 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      0.0 MiB           4864.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35473.58 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2704.1 MiB      416.02 MiB        4608.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35633.6 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2912.11 MiB     0.01 MiB          4608.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35009.58 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.19
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8320.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34135.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5120.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30519.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5120.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30935.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5376.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31191.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5376.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30775.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           5120.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42805.83 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           5120.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35105.56 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     0.0 MiB           5120.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35521.58 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2496.09 MiB     416.02 MiB        4864.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35681.59 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2704.1 MiB      0.01 MiB          4864.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35057.58 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.20
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8576.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34391.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5376.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   30775.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5376.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31191.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5632.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31447.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5632.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31031.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           5376.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42853.82 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           5376.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35153.55 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     0.0 MiB           5376.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35569.57 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2288.09 MiB     416.02 MiB        5120.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35729.58 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2496.09 MiB     0.01 MiB          5120.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35105.57 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.21
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8832.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34647.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5632.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31031.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5632.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31447.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5888.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31703.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5888.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31287.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           5632.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42901.81 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           5632.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35201.55 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     0.0 MiB           5632.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35617.56 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   2080.08 MiB     416.02 MiB        5376.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35777.58 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2288.09 MiB     0.01 MiB          5376.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35153.56 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.22
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9088.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34903.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5888.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31287.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           5888.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31703.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6144.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31959.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6144.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31543.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           5888.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42949.8 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           5888.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35249.54 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     0.0 MiB           5888.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35665.55 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1872.07 MiB     416.02 MiB        5632.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35825.57 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   2080.08 MiB     0.01 MiB          5632.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35201.55 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.23
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9344.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   35159.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6144.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31543.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6144.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31959.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6400.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32215.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6400.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31799.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           6144.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   42997.8 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           6144.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35297.53 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     0.0 MiB           6144.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35713.55 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1664.06 MiB     416.02 MiB        5888.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35873.56 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1872.07 MiB     0.01 MiB          5888.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35249.55 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.24
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9600.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   35415.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6400.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   31799.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6400.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32215.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6656.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32471.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6656.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32055.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           6400.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43045.79 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           6400.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35345.52 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     0.0 MiB           6400.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35761.54 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1456.05 MiB     416.02 MiB        6144.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35921.55 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1664.06 MiB     0.01 MiB          6144.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35297.54 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.25
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           9856.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   35671.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6656.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32055.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6656.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32471.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6912.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32727.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6912.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32311.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           6656.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43093.78 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           6656.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35393.51 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     0.0 MiB           6656.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35809.53 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1248.05 MiB     416.02 MiB        6400.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35969.55 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1456.05 MiB     0.01 MiB          6400.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35345.53 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.26
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           10112.0 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   35927.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6912.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32311.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           6912.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32727.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7168.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32983.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7168.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32567.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           6912.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43141.77 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           6912.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35441.51 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     0.0 MiB           6912.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35857.52 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   1040.04 MiB     416.02 MiB        6656.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36017.54 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1248.05 MiB     0.01 MiB          6656.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35393.52 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.27
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           10368.0 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   36183.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7168.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32567.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7168.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32983.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7424.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33239.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7424.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32823.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      0.0 MiB           7168.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43189.77 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   832.03 MiB      0.0 MiB           7168.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35489.5 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      0.0 MiB           7168.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35905.51 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   832.03 MiB      416.02 MiB        6912.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36065.53 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   1040.04 MiB     0.01 MiB          6912.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35441.51 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.28
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           10624.0 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   36439.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7424.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   32823.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7424.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33239.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7680.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33495.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7680.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33079.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      0.0 MiB           7424.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43237.76 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   624.02 MiB      0.0 MiB           7424.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35537.49 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      0.0 MiB           7424.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35953.51 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   624.02 MiB      416.02 MiB        7168.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36113.52 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   832.03 MiB      0.01 MiB          7168.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35489.51 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.29
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           10880.0 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   36695.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7680.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33079.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7680.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33495.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7936.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33751.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7936.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33335.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      0.0 MiB           7680.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43285.75 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   416.02 MiB      0.0 MiB           7680.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35585.48 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      0.0 MiB           7680.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36001.5 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   416.02 MiB      416.02 MiB        7424.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36161.51 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   624.02 MiB      0.01 MiB          7424.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35537.5 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.30
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11136.0 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   36951.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7936.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33335.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           7936.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33751.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34007.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33591.43 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      0.0 MiB           7936.0 MiB    8542.26 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   43333.74 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   208.01 MiB      0.0 MiB           7936.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35633.48 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      0.0 MiB           7936.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36049.49 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   208.01 MiB      416.02 MiB        7680.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   36209.51 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   416.02 MiB      0.01 MiB          7680.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35585.49 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Module:  FSDPTransformer.layers.31
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
State & Call              Device    Sharded Param    Unsharded Param    Buffer    Sharded Grad    Unsharded Grad    Activation    Temp         All Gather    Reduce Scatter    OptState      Inputs    Total
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
Peak Forward # 1          cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           11392.0 MiB   0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   37207.44 MiB
Before Pre-Forward # 1    cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   33591.43 MiB
After Pre-Forward # 1     cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34007.44 MiB
Before Post-Forward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8448.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34263.44 MiB
After Post-Forward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8448.0 MiB    0.0 MiB      416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   34263.44 MiB
Peak Backward # 1         cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    8542.26 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   42549.7 MiB
Before Pre-Backward # 1   cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    1258.01 MiB  0.0 MiB       0.0 MiB           15316.65 MiB  0.5 MiB   34849.44 MiB
After Pre-Backward # 1    cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         0.0 MiB           8192.0 MiB    1258.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   35265.45 MiB
Before Post-Backward # 1  cuda:0    7658.25 MiB      2420.02 MiB        4.0 MiB   0.0 MiB         416.02 MiB        7936.0 MiB    1258.01 MiB  416.02 MiB    0.0 MiB           15316.65 MiB  0.5 MiB   35425.47 MiB
After Post-Backward # 1   cuda:0    7658.25 MiB      2004.01 MiB        4.0 MiB   208.01 MiB      0.01 MiB          7936.0 MiB    1258.01 MiB  416.02 MiB    832.03 MiB        15316.65 MiB  0.5 MiB   35633.48 MiB
========================  ========  ===============  =================  ========  ==============  ================  ============  ===========  ============  ================  ============  ========  ============
peak active: 4.76837158203125e-07 GiB | peak reserved: 0.001953125 GiB | num_retries: 0
Tracker Max: 78.31596231460571 GiB
[2025-07-25 06:33:28] ✓ Estimation completed successfully

================================================================================
                              Estimation Complete
================================================================================

Results saved to: /root/torchtitan/fsdp_memory_estimates
Log file: /root/torchtitan/fsdp_memory_estimates/fsdp_estimates_20250725_063111.log

To compare with debug_simpleFSDP.sh results:
  1. Run debug_simpleFSDP.sh and check debug.log for actual memory usage
  2. Compare with estimates in: /root/torchtitan/fsdp_memory_estimates/fsdp_estimates_20250725_063111.log
  
Expected format in debug.log:
  step: X  loss: X.XXXX  grad_norm: X.XXXX  memory: XX.XXGiB(XX.XX%)  tps: X,XXX
  
Use the peak memory values from multiple steps to compare with estimates.
================================================================================
[2025-07-25 06:33:28] Script completed successfully
